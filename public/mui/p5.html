<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <title></title>
    <script src="js/mui.min.js"></script><script src="js/config.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <link href="css/test.css" rel="stylesheet"/>
    <script type="text/javascript" charset="utf-8">
      	mui.init({
      		
      	});
    </script>
     <script src="js/jquery-1.7.2.min.js"></script>
     <style>
     	.mui-bar .mui-btn {
    		padding: 4px 10px 5px;
    	}
    	.rxd{ background: red;}
    	.bxd{background: dodgerblue;}
    	.ww,.qw,.bw,.sw,.gw{width:18%;height:100px;float:left;text-align: center;}
    	.bw_ball,.sw_ball;.gw_ball{width:80%;height: 100px;float: left;}
    	.sj_font{display: block;float: right;color: gray;font-size: 12px;padding-right: 10px;padding-top: 4px;}
    	.choose_rball{margin-left: 6px;}
    	#index_main {
		    height: 455px;
		}
		.add_tb li{list-style-type: none;}
    	.mui-switch:before { top: -5px;}
    	.mui-switch.mui-active {
		    border-color: #007aff;
		    background-color: #007aff;
		}
     </style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
		<div class='head_choose'>
		    <div class='jt' style='float: left;'><a href='index.html' class="jt_back mui-icon mui-icon-left-nav mui-pull-left"></a></div>
		    <h1 class="mui-title"><span id='ttz'>排列五</span></h1>
		    <div class='menu' style='float: right;'><a href="#popover_right" id="openPopover"><span class="mui-icon mui-icon-bars"></span></a></div>
	    </div>
	    
	    <div class="head_ready">
	    	 <a class=" bk mui-icon mui-icon-left-nav mui-pull-left"></a>
	    <h1 class="mui-title">确认选单</h1>
	    </div>
	</header>
	<!--顶部右边菜单-->
	<div id="popover_right" class="mui-popover">
	  <ul class="mui-table-view">
	    <li class="mui-table-view-cell"><a href="#">玩法说明</a></li>
	    <li class="mui-table-view-cell"><a href="#">历史开奖</a></li>
	    <li class="mui-table-view-cell p5_chart"><a href="javascript:void(0)">走势图</a></li>
	    <!--<li class="mui-table-view-cell"><a href="#">Item3</a></li>
	    <li class="mui-table-view-cell"><a href="#">Item4</a></li>
	    <li class="mui-table-view-cell"><a href="#">Item5</a></li>-->
	  </ul>
	</div>
	<input type="hidden" id='tz_bj' value='0' />
	
	<!--底部固定栏-->
	<nav id="footerBar" class="mui-bar mui-bar-tab">
		<div class='foot_choose'>
			<div class='footer_font'>共0元</div>
			<div class='footer_next'><button id='next' type="button" class="mui-btn mui-btn-danger h_gao" style='width:80%'>下一步</button></div>
		</div>
		<div class="foot_ready">
			<!--<div id="bs" style="height: 44px;">
				<button type="button" id='jia' class="mui-btn mui-btn-primary">+</button>
				<div class='bb'><div class='bs_num'>1</div><div class='bs_font'>倍</div></div>
				<button type="button" class="mui-btn mui-btn-primary jian">-</button><div class="clear"></div>
			</div>
			<div class='clear'></div>
			<div id='total_money'>
				金额:<span class='total_mon'></span>元 
			</div>
			<div class='bs_btn'>
				<button type="button" id='sub' class="mui-btn mui-btn-danger">提交彩店</button><button type="button" id='save' class="mui-btn">保存</button>
				
			</div>
			<div class='bs_buttom_font'>
				
				<p class='p2'><input type="checkbox" checked="checked"  disabled="disabled"/>同意《希迈尔代购协议》并已经认可投注详情</p>
			</div>-->
			<div class='foot_list'>
				<div class='bs_buttom_font'>
					<p class='p2'><input type="checkbox" checked="checked"  disabled="disabled"/>同意《希迈尔代购协议》并已经认可投注详情</p>
				</div>
			</div>
			<div class='foot_list'>
				<div class='bs_fonts'>倍数：<span class='bs_nn'>1</span></div>
				<div class='bs_tb'>
					<button type="button" id='jia' class="mui-btn mui-btn-primary">+</button>
					<div class='bb'><div class='bs_num'>1</div></div>
					<button type="button" class="mui-btn mui-btn-primary jian">-</button>
					<div class="clear"></div>
				</div>
			</div>
			<!--<div class='foot_list'>
				<div class='add_font'>
					追加(每注3元)：<span class='add_bj'>是</span>
				</div>
				<div class='add_tb' style='width:38%'>
		    		<li class="mui-table-view-cell" style='padding: 20px 15px;'>
		    			<input type="hidden" class='add_zj' value=''/>
						<div class="mui-switch mui-active">
							<div class="mui-switch-handle"></div>
						</div>
					</li>
				</div>
			</div>-->
			<div class='foot_list'>
				<div class='zs_font'>
					注数：<span class='zs_num'></span>
				</div>
				<div class='mon_font' style='text-align: center;'>
					金额：&nbsp;&nbsp;&nbsp;<span class='total_mon' style='color:red'></span>&nbsp;&nbsp;元
				</div>
			</div>
			<div class='foot_list' style='height: 50px'>
				<button id='sub' type="button" class="mui-btn mui-btn-red" style='margin-left: 5%;width: 40%;height: 34px;margin-top: 8px;'>提交彩店</button>
				<button id='save' type="button" class="mui-btn mui-btn-blue" style='margin-left: 8%;width: 40%;height: 34px;margin-top: 8px;'>保存方案</button>
			</div>
		</div>
	</nav>
	
	<div class="mui-content">
		<div class='choose'>
		<!--顶部开奖时间-->
	    <div class='kj_time'>
	    	<span class='kjt'><span class='now_qi'></span>&nbsp;&nbsp;今天20:00截止，20:30开奖</span>
	    	<div class='jt_round'><img class='jt_change' src="wimages/jt_round_down.png" alt="" width='20' height="20" /></div>
	    	<input type="hidden" value="0" class='jt_v' />
	    </div>
	    <!--历史开奖-->
	   	<div class="history">
	   		<div class='h_top'>
	   			<span class='q_all'>期号</span>
	   			<span class='k_all'>开奖号码</span>
	   		</div>
	   		<div class="clear"></div>
	   		<div class='h_main'>
	   		
	   		
	   		</div>
	   	</div>
	   	<div class='clear'></div>
	    	
	    
		    <!--机选-->
		    <div class="index_top"><span class='sj'>机选</span><span class='sj_font'>每位最少选1个，奖金<span style='color:red'>100000元</span></span></div>		
		    <!--选择球-->
		    <div id='index_main'>
		    	<div class='zx_choose'>
		    		<div id='index_main4' style='height:100px;border-bottom:1px solid lightgray;margin-top: 18px;'>
				    	<div class='ww'>万位</div>
				    	<div class='ww_ball'></div>
				    </div>
				    <div id='index_main5' style='height:100px;border-bottom:1px solid lightgray;margin-top: 18px;'>
				    	<div class='qw'>千位</div>
				    	<div class='qw_ball'></div>
				    </div>
				    <div id='index_main1' style='height:100px;border-bottom:1px solid lightgray;margin-top: 18px;'>
				    	<div class='bw'>百位</div>
				    	<div class='bw_ball'></div>
				    </div>
				  	<div id='index_main2' style='height:100px;border-bottom:1px solid lightgray;margin-top: 18px;'>
				  		<div class='sw'>十位</div>
				    	<div class='sw_ball'></div>
				  	</div>
				  	<div id='index_main3' style='height:100px;margin-top: 18px;'>
				  		<div class='gw'>个位</div>
				    	<div class='gw_ball'></div>
				  	</div>
			  	</div>
			  	
			  	<input id='red_num' type="hidden" value='0'>
				<input id='blue_num' type="hidden" value='0'>
				<input id='money' type="hidden" value='0'>
				<input id='tz' type="hidden" value='0'>
				<input id='rr_dan' type="hidden" value='0' />
				<input id='bb_dan' type="hidden" value='0' />
				<input id='to_tz' type="hidden" value='0'  />
				<input type="hidden" value='0' class='person' />
				
		   	</div>   
	   
	</div>
	<div class="yes"></div>
	<div class='saj' style='display: none'></div>
	
	<div class="ready">
		   <div class='end_time'>
	    	<span><span class='now_qi'></span>&nbsp;&nbsp;<span class='e_time'>05-14 20:00</span>停售</span>	    
	    </div>
	    <div class="re_btn">
	    	<button type="button" id='hand' class="mui-btn mui-btn-primary mui-btn-outlined">手选号码</button>
	    	<button type="button" id='robot' class="mui-btn mui-btn-primary mui-btn-outlined">机选一注</button>
	    	<div class="clear"></div>
	    </div>
	    <div class='preview'></div>
	    
	</div>
	
</div>
	
</body>
<script src="js/tk_check.js"></script>
<script type="text/javascript">
	var token=window.localStorage.getItem('token');
	//alert(token);
reset();//进页面重置一下
function xh_red(){
	//循环红球
	var b='';
	for(var i=0;i<10;i++){
		b+="<div class='r_ball'><span>"+i+"</span></div><input class='checkbox_h1' type='hidden' value="+i+"><input class='r_dan' type='hidden' value='0'>";						
	}
	
	jQuery('.ww_ball').append(b);
	jQuery('.qw_ball').append(b);
	jQuery('.bw_ball').append(b);
	jQuery('.sw_ball').append(b);
	jQuery('.gw_ball').append(b);
}
xh_red();

	var url = window.location.search;
    var loc = url.substring(url.lastIndexOf('=')+1, url.length);
    var s_id=url.substring(url.lastIndexOf('?')+1,3);
    	
    	if(loc=='update'){
    		$('.jt_back').attr('href','p5_sec.html');
    		/*jQuery(document).on('tap','.jt_back',function(){
		    	mui.openWindow({
				    url: 'p5_sec.html', 
				    id:'p5'						 
				});
		    })*/
   			var num=window.localStorage.getItem('update_num');
   			var up_num=JSON.parse(num);
   			console.log(up_num);
   			var red_w=jQuery('.ww_ball .r_ball');
   			//console.log(red_w)
   			var red_q=jQuery('.qw_ball .r_ball');
   			var red_b=jQuery('.bw_ball .r_ball');
			var red_s=jQuery('.sw_ball .r_ball');
			var red_g=jQuery('.gw_ball .r_ball');
			var arr=up_num.num.split('|');
			console.log(arr)
			if(arr[0].indexOf(',') > -1){
	  			var brr=[];
	  			brr=arr[0].split(',');
	  			
	  			for(var i=0;i<brr.length;i++){
					red_w.eq(brr[i]).addClass("rxq").next().next().val(1);																					
				}
	  		}else if(arr[0].indexOf(',') == -1){							  					red_w.eq(arr[0]).addClass("rxq").next().next().val(1);																							
				
	  		}
	  		
	  		if(arr[1].indexOf(',') > -1){
	  			var crr=[];
	  			crr=arr[1].split(',');
	  			
	  			for(var j=0;j<crr.length;j++){
					red_q.eq(crr[j]).addClass("rxq").next().next().val(1);
				}
	  		}else if(arr[1].indexOf(',') == -1){							  			
					red_q.eq(arr[1]).addClass("rxq").next().next().val(1);																							
	  		}
	  		
	  		if(arr[2].indexOf(',') > -1){
	  			var drr=[];
	  			drr=arr[2].split(',');
	  			
	  			for(var k=0;k<drr.length;k++){
					red_b.eq(drr[k]).addClass("rxq").next().next().val(1);
				}
	  		}else if(arr[2].indexOf(',') == -1){							  			
					red_b.eq(arr[2]).addClass("rxq").next().next().val(1);																							
	  		}
	  		
	  		if(arr[3].indexOf(',') > -1){
	  			var err=[];
	  			err=arr[3].split(',');
	  			
	  			for(var v=0;v<err.length;v++){
					red_s.eq(err[v]).addClass("rxq").next().next().val(1);																						
				}
	  		}else if(arr[3].indexOf(',') == -1){							  					red_s.eq(arr[3]).addClass("rxq").next().next().val(1);																										
				
	  		}
	  		
	  		if(arr[4].indexOf(',') > -1){
	  			var frr=[];
	  			frr=arr[4].split(',');
	  			
	  			for(var p=0;p<frr.length;p++){
					red_g.eq(frr[p]).addClass("rxq").next().next().val(1);																								
				}
	  		}else if(arr[4].indexOf(',') == -1){							  					red_g.eq(arr[4]).addClass("rxq").next().next().val(1);																								
				
	  		}
	  		
	  		
		  		
   			
    	}
    	
    	$(document).on('tap','.p5_chart',function(){
	    	mui.plusReady(function () {
				var web=plus.webview.getWebviewById('Rfive_chart_main');
				var web_child=plus.webview.getWebviewById('Rfive_chart.html');
				//web.show();
				if(web){
					//alert(222)
					web.show();
					web_child.show();
				}else{
					//alert(333)
					mui.openWindow({
					    url: 'Rfive_chart_main.html', 
					    id:'Rfive_chart_main',
					    createNew:true
					});
				}
	        	
				             
	    	});
	    	//alert(2)
	    	/*mui.openWindow({
			    url: 'Lotto_chart_main.html', 
			    //id:'index',
			    createNew:true
			});*/
	   
    	})
    
    
   	//console.log(save_id);
    	if(loc=='show'){
    		jQuery('.choose,.foot_choose,.head_choose').attr('style','display:none');
			jQuery('.head_ready,.ready,.foot_ready').attr('style','display:block');
			var cp_h=window.localStorage.getItem('cp_hm');
			jQuery('.yes').html(cp_h);
			var to_m=window.localStorage.getItem('to_money');
			var to_z=window.localStorage.getItem('to_z');
			var to_b=window.localStorage.getItem('to_b');
			var xhye=window.localStorage.getItem('xhy');
			jQuery('#to_tz').val(to_z);
			jQuery('.zs_num').text(to_z);
			jQuery('.total_mon').text(to_m);
			jQuery('.bs_num').text(to_b);
			jQuery('.bs_nn').text(to_b);
			jQuery('.preview').html(xhye);
			
    	} 
    	
    	if(s_id=='id'){
    		var save_id=url.substring(url.lastIndexOf('=')+1, url.length);
    		//console.log(save_id);
    		jQuery('.choose,.foot_choose,.head_choose').attr('style','display:none');
			jQuery('.head_ready,.ready,.foot_ready').attr('style','display:block');
    		mui.ajax(config[0].url+'/index.php/save_detail',{
			 	data:{
			  		id:save_id,
			  	},
			  	dataType:'json',//服务器返回json格式数据
			  	type:'post',//HTTP请求类型
			  	timeout:10000,//超时时间设置为10秒；
			  	success:function(data){
				    if(typeof data == "string") {var data = eval('('+data+')');}
				 	console.log(data);
				 	$('.yes').html(data[0].save_num);
				 	$('#to_tz').val(data[0].save_z);
				 	$('.zs_num').text(data[0].save_z);
				 	$('.total_mon').text(data[0].save_money);
				 	$('.bs_num').text(data[0].save_b);
				 	$('.bs_nn').text(data[0].save_b);
				 	$('.preview').html(data[0].save_style);
					
					
				 	
			  	},
			  	error:function(xhr,type,errorThrown){
				  	//异常处理；
				    //console.log(type);
					switch (type) {
						case "timeout":
							mui.toast('连接超时，请重试');
							break;
						default:
							mui.toast('请重试或重新登录');
					}
				}
			});
    	}
    
    
    /*jQuery('.jt_back').on('tap',function(){
    	mui.openWindow({
		    url: 'index.html', 
		    id:'index'						 
		});
    })*/
    
    mui.ajax(config[0].url+'/index.php/cp_qi',{
			 	data:{
			  		types:'04',
			  	},
			  	dataType:'json',//服务器返回json格式数据
			  	type:'post',//HTTP请求类型
			  	timeout:10000,//超时时间设置为10秒；
			  	success:function(data){
				    if(typeof data == "string") {var data = eval('('+data+')');}
				    /*console.log(JSON.stringify(data));*/
				 	//console.log(data);
				 	$('.now_qi').text('排五'+data+'期');
			  	},
			  	error:function(xhr,type,errorThrown){
				  	//异常处理；
				    //console.log(type);
					switch (type) {
						case "timeout":
							mui.toast('连接超时，请重试');
							break;
						default:
							mui.toast('请重试或重新登录');
					}
				}
			});
    


//userid判断
 function numbers_check(obj){    
        reg=/^[0-9]+.?[0-9]*$/;;    
        if(!reg.test(obj)){   
           return false;
        }else{   
           return true;
        }
}

	//判断数组是否相等
	function isContained(a, b){
	   var astr=a.sort().toString();
	   var bstr=b.sort().toString();
	   if(astr==bstr){
	   		return true;
	   }else{
	   		return false;
	   }
	}

var userid = window.localStorage.getItem("token");
mui.ajax(config[0].url+'/index.php/personal_check', {
            data: {
                userid: userid
            },
            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
            timeout: 10000,//超时时间设置为10秒；
            success: function (data) {
                if (typeof data == "string") {
                    var data = eval('(' + data + ')');
                }
                 if (data == false) {
                    $('.person').val(2);
                    
                }else if(data[0].active==1){
                	$('.person').val(3);
                }else if (data[0].real_name == '' || data[0].real_name == null || data[0].real_name == undefined || data[0].idcard_numer == '' || data[0].idcard_numer == null || data[0].idcard_numer == undefined) {
                	$('.person').val(1);
                	

                }else{
                	$('.person').val(0);
                }


            },
            error: function (xhr, type, errorThrown) {
                //异常处理；
                //console.log(type);
				switch (type) {
					case "timeout":
						mui.toast('连接超时，请重试');
						break;
					default:
						mui.toast('请重试或重新登录');
				}
            }
        });

	
	
	
	
/*下一步*/
jQuery('#next').on('tap',function(){
	var r_num=jQuery('#red_num').val();
	var ww_num=$('.ww_ball .rxq').length;
	var qw_num=$('.qw_ball .rxq').length;
	var bw_num=$('.bw_ball .rxq').length;
	var sw_num=$('.sw_ball .rxq').length;
	var gw_num=$('.gw_ball .rxq').length;
	var t_num=jQuery('#tz').val();
	var red_d=jQuery('#rr_dan').val();
	var mom=parseInt(jQuery('#money').val());
	var timestamp=new Date().getTime();
	
	if($('.person').val()==1){
		mui.alert('身份未完善，请去完善个人资料', '资料未完善', function() {
        	mui.openWindow({
			    url: 'zx_personal.html', 
			    id:'zx_personal',
			    createNew:true
			});
		
		});
		return;
	}else if($('.person').val()==2){
		mui.alert('用户未登录', '用户未登录', function() {
        	mui.openWindow({
			    url: 'login.html', 
			    id:'login',
			    createNew:true
			});
		
		});
		return;
	}else if($('.person').val()==3){
		mui.alert('用户被禁用', '用户被禁用', function() {
        	mui.openWindow({
			    url: 'login.html', 
			    id:'login',
			    createNew:true
			});
		
		});
		return;
	}
	
	if(mom>20000){
		mui.toast('单注不能超过20000元');
		reset();
	}else{
		
			if(ww_num<1 || qw_num<1 || bw_num<1 || sw_num<1 || gw_num<1){					
				mui.toast('每位至少选一个');
			}else{
				var aa='';
				var bb='';
				var cc='';
				var dd='';
				var ee='';
				var ff='';
				var dd=jQuery('.ww_ball .r_ball.rxq').next();
				var ee=jQuery('.qw_ball .r_ball.rxq').next();
				var aa=jQuery('.bw_ball .r_ball.rxq').next();
				var bb=jQuery('.sw_ball .r_ball.rxq').next();
				var cc=jQuery('.gw_ball .r_ball.rxq').next();
				//console.log(aa);return;
				var arr=[];
				var brr=[];
				var crr=[];
				var drr=[];
				var err=[];
				jQuery.each(aa, function(i,val){
					/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
					console.log(i); //输出索引为0，1，2，3			
					console.log(val.value); //输出value的值*/
					arr[i]=val.value;
				}); 
				
				jQuery.each(bb, function(i,val){
					/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
					console.log(i); //输出索引为0，1，2，3			
					console.log(val.value); //输出value的值*/
					brr[i]=val.value;
				});
				
				jQuery.each(cc, function(i,val){
					/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
					console.log(i); //输出索引为0，1，2，3			
					console.log(val.value); //输出value的值*/
					crr[i]=val.value;
				});
				
				jQuery.each(dd, function(i,val){
					/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
					console.log(i); //输出索引为0，1，2，3			
					console.log(val.value); //输出value的值*/
					drr[i]=val.value;
				});
				
				jQuery.each(ee, function(i,val){
					/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
					console.log(i); //输出索引为0，1，2，3			
					console.log(val.value); //输出value的值*/
					err[i]=val.value;
				}); 
				
				
				cp_num =drr+'|'+err+'|'+ arr+'|'+brr+'|'+crr;
				//console.log(cp_num)
				if(loc=='update'){
						var ud_num=window.localStorage.getItem('update_num');
						var now_num=window.localStorage.getItem('nb');
	   					var up_num=JSON.parse(ud_num);
	   					var nows_num=JSON.parse(now_num);
	   					var space=up_num.sp;
	   					nows_num[space].num=cp_num;
	   					nows_num[space].z=t_num;
	   					
	   					window.localStorage.setItem('nb',JSON.stringify(nows_num));
	   					mui.openWindow({
							url: 'p5_sec.html', 
							id:'p5_sec',
							createNew:true
						});
						return;
	   					
	   					
					};
				var nb=window.localStorage.getItem('nb');
				console.log(nb);
				if(nb!=''){
					var num=JSON.parse(nb);
					var add = {'num':cp_num,'z':t_num};
					num.push(add);
					console.log(num)
					window.localStorage.setItem('nb',JSON.stringify(num));
					if(!window.localStorage.getItem("token")){
						window.localStorage.setItem('next','p5');
						mui.openWindow({
							url: 'login.html', 
							id:'login',
							createNew:true
						});
						return;
					}
					mui.openWindow({
						url: 'p5_sec.html', 
						id:'p5_sec',
						createNew:true
					});
					return;
				}else{
					var nb=[];
					var add = {'num':cp_num,'z':t_num};
					nb.push(add);
					console.log(nb)
					window.localStorage.setItem('nb',JSON.stringify(nb));
					if(!window.localStorage.getItem("token")){
						window.localStorage.setItem('next','p5');
						mui.openWindow({
							url: 'login.html', 
							id:'login',
							createNew:true
						});
						return;
					}
					mui.openWindow({
						url: 'p5_sec.html', 
						id:'p5_sec',
						createNew:true
					});
					return;
				}
				
				var ww_len=drr.length;
				var qw_len=err.length;
				var bw_len=arr.length;
				var sw_len=brr.length;
				var gw_len=crr.length;
				var b='';
				var a='';
				var c='';
				var d='';
				var e='';
				var f='';
				var g='';
				
				for(var p=0;p<ww_len;p++){
					f+="<div class='choose_rball rxq'>"+drr[p]+"<input class='choose_h1' type='hidden' value="+drr[p]+"></div>";
				}
				
				for(var u=0;u<qw_len;u++){
					g+="<div class='choose_rball rxq'>"+err[u]+"<input class='choose_h1' type='hidden' value="+err[u]+"></div>";
				}
				
				for(var i=0;i<bw_len;i++){
					a+="<div class='choose_rball rxq'>"+arr[i]+"<input class='choose_h1' type='hidden' value="+arr[i]+"></div>";
				}
				
				for(var k=0;k<sw_len;k++){
					b+="<div class='choose_rball rxq'>"+brr[k]+"<input class='choose_h1' type='hidden' value="+brr[k]+"></div>";
				}
				
				for(var j=0;j<gw_len;j++){
					c+="<div class='choose_rball rxq'>"+crr[j]+"<input class='choose_h1' type='hidden' value="+crr[j]+"></div>";
				}
				
				c=c+"<div class='clear'></div>";
				d=f+"<div class='ww' style='float: left;width: 9px;height: 21px;text-align: center;color: gray;margin-left: 5px;'>|</div>"+g+"<div class='gg' style='float: left;width: 9px;height: 21px;text-align: center;color: gray;margin-left: 5px;'>|</div>"+a+"<div class='one' style='float: left;width: 9px;height: 21px;text-align: center;color: gray;margin-left: 5px;'>|</div>"+b+"<div class='two' style='float: left;width: 9px;height: 21px;text-align: center;color: gray;margin-left: 5px;'>|</div>"+c;
				e="<div class='xh'><div class='xh_close'>x</div><div class='xhm'>"+d+"</div><input class='t_dz' type='hidden' value='"+t_num+"'><div class='rjt'>></div><input class='save_bj' type='hidden' value='"+timestamp+"'><div class='clear'></div></div>";
				jQuery('.preview').append(e);
			}
		
		}
		
})
	
//求两个数组差集
function minus(arr1,arr2){
    var arr3 = [];
    for (var i = 0; i < arr1.length; i++) {
                        var flag = true;
                        for (var j = 0; j < arr2.length; j++) {
                            if (arr2[j] == arr1[i]) {
                                flag = false;
                            }
                        }
                        if (flag) {
                            arr3.push(arr1[i]);
                        }
                    }
return arr3;
}

	
	/*机选一注*/
	jQuery('#robot').on('tap',function(){
			var t_num=1;
			var b='';
			var a='';
			var c='';
			var d='';
			var e='';
			var f='';
			var g='';
			var arr=[];
			var timestamp=new Date().getTime();
			
			
				for(var n=0;n<5;n++){
					arr[n]= Math.floor(Math.random()*10);
				}
				f = "<div class='choose_rball rxq'>"+arr[3]+"<input class='choose_h1' type='hidden' value="+arr[3]+"></div>";
				
				g = "<div class='choose_rball rxq'>"+arr[4]+"<input class='choose_h1' type='hidden' value="+arr[4]+"></div>";
				
				a = "<div class='choose_rball rxq'>"+arr[0]+"<input class='choose_h1' type='hidden' value="+arr[0]+"></div>";
				
				b = "<div class='choose_rball rxq'>"+arr[1]+"<input class='choose_h1' type='hidden' value="+arr[1]+"></div>";
				
				c = "<div class='choose_rball rxq'>"+arr[2]+"<input class='choose_h1' type='hidden' value="+arr[2]+"></div>"; 
				
				f = f+"<div class='ww' style='float: left;width: 9px;height: 21px;text-align: center;color: gray;margin-left: 5px;'>|</div>";
				
				g = g+"<div class='gg' style='float: left;width: 9px;height: 21px;text-align: center;color: gray;margin-left: 5px;'>|</div>";
				
				a = a+"<div class='one' style='float: left;width: 9px;height: 21px;text-align: center;color: gray;margin-left: 5px;'>|</div>";
				b = b+"<div class='two' style='float: left;width: 9px;height: 21px;text-align: center;color: gray;margin-left: 5px;'>|</div>";
				
				cp_num =arr[3]+'|'+arr[4]+'|'+arr[0]+'|'+arr[1]+'|'+arr[2];
				var cp_now = $('.yes').text();
				if(cp_now==''){
					sj_cp = cp_num+cp_now;
				}else{
					sj_cp = cp_num+'_'+cp_now;
				}
				var cp_now = $('.yes').text(sj_cp);
				
			d=f+g+a+b+c+"<div class='clear'></div>";
			e="<div class='xh'><div class='xh_close'>x</div><div class='xhm'>"+d+"</div><input class='t_dz' type='hidden' value='"+t_num+"'><div class='rjt'>></div><input class='save_bj' type='hidden' value='"+timestamp+"'><div class='clear'></div></div>";
			

		jQuery('.preview').append(e);
	})
	
	/*初始化选号页面*/
	function reset(){
			var red=jQuery('.r_ball');
			var blue=jQuery('.b_ball');
			red.removeClass('rxq').removeClass('rr_dan').removeClass('rd');
			blue.removeClass('bxq').removeClass('dd_dan').removeClass('bd');
			jQuery('.font_rdan').remove();
			jQuery('.r_ball').children('span').removeClass('font_num');
			jQuery('.font_bdan').remove();
			jQuery('.b_ball').children('span').removeClass('font_num');
			jQuery('.footer_font').html('共0元');
			jQuery('#red_num').val(0);
			jQuery('#blue_num').val(0);
			jQuery('#money').val(0);
			jQuery('#rr_dan').val(0);
			jQuery('#bb_dan').val(0);
			jQuery('#tz').val(0);
			jQuery('.r_dan').val(0);
			jQuery('.b_dan').val(0);
			
	}
	
	
	
	/*返回选号画面*/
	jQuery('#hand,.bk').on('tap',function(){
		jQuery('.choose,.foot_choose,.head_choose').attr('style','display:block');
		jQuery('.head_ready,.ready,.foot_ready').attr('style','display:none');
		
			reset();//调用初始化选号页面
	})
	
				//倍数
				jQuery('#jia').on('tap',function(){
										
						var numm=parseInt(jQuery('.bs_num').text());											
						numm++;
						if(numm>99){
							numm=99;
						}
						jQuery('.bs_num').text(numm);
						jQuery('.bs_nn').text(numm);
								
				})
				
				jQuery('.jian').on('tap',function(){
										
						var numm=parseInt(jQuery('.bs_num').text());											
						numm--;
						if(numm<1){
							numm=1;	
						}
						jQuery('.bs_num').text(numm);
						jQuery('.bs_nn').text(numm);
								
				})
				
				function m_on(){
					var ww_n=jQuery('.ww_ball .rxq').length; 
					var qw_n=jQuery('.qw_ball .rxq').length;
					var bw_n=jQuery('.bw_ball .rxq').length;
					var sw_n=jQuery('.sw_ball .rxq').length;
					var gw_n=jQuery('.gw_ball .rxq').length;
					var mo=jQuery('#money').val();
						//随时计算金额数
					if(ww_n<1 || qw_n<1 || bw_n<1 || sw_n<1 || gw_n<1){
						jQuery('.footer_font').html('共0元');
					}else{
							var money=parseInt(ww_n*qw_n*bw_n*sw_n*gw_n*2);
							var num= parseInt(money/2);
							jQuery('#money').val(money);
							jQuery('#tz').val(num);
	
						jQuery('.footer_font').html(function(){
							return "共"+money+"元";
						});
					}
					
				}
				
				m_on();
				
					
				
				
				
				
		jQuery(document).on('tap',function(){
				var ww_n=jQuery('.ww_ball .rxq').length; 
				var qw_n=jQuery('.qw_ball .rxq').length;
				var bw_n=jQuery('.bw_ball .rxq').length;
				var sw_n=jQuery('.sw_ball .rxq').length;
				var gw_n=jQuery('.gw_ball .rxq').length;
				var mo=jQuery('#money').val();
				var rdan_num=parseInt(jQuery('#rr_dan').val()); 
				var bdan_num=parseInt(jQuery('#bb_dan').val()); 
				/*var re=parseInt(red_n-rdan_num);
				var blu=parseInt(blue_n-bdan_num);*/
				
				
				/*预览页面金额计算*/
				var total_tz=jQuery('.t_dz');
				var trr=[];
				jQuery.each(total_tz, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				trr[i]=parseInt(val.value);
				
			}); 
				 var to=eval(trr.join('+'));
				 var numm=jQuery('.bs_num').text();
				 jQuery('#to_tz').val(to);
				 jQuery('.zs_num').text(to);
				 //alert(to)
				 if(to==undefined || to==''){
				 	to = 0;
				 }
				 	
					var t_money=to*2*numm;
					jQuery('.total_mon').text(t_money);
							
						
						
				
				
				/*删除选中号*/
				jQuery('.xh_close').on('tap',function(){
					
					var r_xh=jQuery(this).next().children('.rxq').children();				
					var arr=[];	
					var brr=[];	
					var err=[];
					var drr=[];
					var grr=[];
						
					for(var j=0;j<r_xh.length;j++){
						arr[j]=r_xh[j].value;
					}
					
					//console.log(arr);
					var ww_red=$(this).next().children('.ww').prevUntil().children('.choose_h1');
					var qw_red=$(this).next().children('.gg').prevUntil('.ww').children('.choose_h1');
					var bw_red=$(this).next().children('.one').prevUntil('.gg').children('.choose_h1');
					var sw_red=$(this).next().children('.two').prevUntil('.one').children('.choose_h1'); 
					var gw_red=$(this).next().children('.two').nextUntil().children('.choose_h1'); 
					var arr=[];
					var brr=[];
					var crr=[];
					var drr=[];
					var err=[];
					
					jQuery.each(ww_red, function(i,val){
						/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
						console.log(i); //输出索引为0，1，2，3
						
						console.log(val.value); //输出value的值*/
						drr[i]=val.value;
						
					});
					
					jQuery.each(qw_red, function(i,val){
						/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
						console.log(i); //输出索引为0，1，2，3
						
						console.log(val.value); //输出value的值*/
						err[i]=val.value;
						
					}); 
				
								
					jQuery.each(bw_red, function(i,val){
						/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
						console.log(i); //输出索引为0，1，2，3
						
						console.log(val.value); //输出value的值*/
						arr[i]=val.value;
						
					}); 
				
					//console.log(arr);
					jQuery.each(sw_red, function(i,val){
						/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
						console.log(i); //输出索引为0，1，2，3
						
						console.log(val.value); //输出value的值*/
						brr[i]=val.value;
						
					}); 
					
					//console.log(brr);
					
					jQuery.each(gw_red, function(i,val){
						/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
						console.log(i); //输出索引为0，1，2，3
						
						console.log(val.value); //输出value的值*/
						crr[i]=val.value;
						
					});
					
					if(drr.length>1){
						px(drr,drr.length);
						var ww_nn=drr.join(',');
					}else if(drr.length==1){
						var ww_nn=drr[0];
					}
					
					if(err.length>1){
						px(err,err.length);
						var qw_nn=err.join(',');
					}else if(err.length==1){
						var qw_nn=err[0];
					}

					if(arr.length>1){
						px(arr,arr.length);
						var bw_nn=arr.join(',');
					}else if(arr.length==1){
						var bw_nn=arr[0];
					}
					
					if(brr.length>1){
						px(brr,brr.length);
						var sw_nn=brr.join(',');
					}else if(brr.length==1){
						var sw_nn=brr[0];
					}
					
					if(crr.length>1){
						px(crr,crr.length);
						var gw_nn=crr.join(',');
					}else if(crr.length==1){
						var gw_nn=crr[0];
					}

					var cp_num =ww_nn+'|'+qw_nn+'|'+ bw_nn+'|'+sw_nn+'|'+gw_nn;
				
					
					//alert(cp_num);
					var cp_now = $('.yes').text();
					var cp_pd = cp_now.indexOf("_");
					if(cp_pd>-1){
						var new_cp = cp_now.replace("_"+cp_num, "");
						var new_cp = new_cp.replace(cp_num, "");
					}else{
						var new_cp = cp_now.replace(cp_num, "");
					}
					var cp_now = $('.yes').text(new_cp);		
					var de=jQuery(this).parent().html();
					var thishm = '<div class="xh">'+de+'</div>';
					
					var isnum = window.localStorage.getItem("num");
					if(isnum){
						var ret=isnum.replace(thishm, "");
					window.localStorage.setItem('num',ret);
					}
					
					jQuery(this).parent().remove();
							
					 
	
				})	
				
					/*修改选中号*/
		jQuery('.rjt').on('tap',function(){
			jQuery(this).addClass('update');
			var r_ba=jQuery(this).prev().prev().children('.choose_rball.rxq').children('.choose_h1');
			var r_nu=parseInt(jQuery('#red_num').val());
			jQuery('.choose,.foot_choose,.head_choose').attr('style','display:block');
			jQuery('.head_ready,.ready,.foot_ready').attr('style','display:none');
			reset();//调用初始化选号页面
			var red_w=jQuery('.ww_ball .r_ball');
			var red_q=jQuery('.qw_ball .r_ball');
			var red_b=jQuery('.bw_ball .r_ball');
			var red_s=jQuery('.sw_ball .r_ball');
			var red_g=jQuery('.gw_ball .r_ball');
			
			var ww_red=$(this).prev().prev().children('.ww').prevUntil().children('.choose_h1');
			var qw_red=$(this).prev().prev().children('.gg').prevUntil('.ww').children('.choose_h1');
			var bw_red=$(this).prev().prev().children('.one').prevUntil('.gg').children('.choose_h1');
			var sw_red=$(this).prev().prev().children('.two').prevUntil('.one').children('.choose_h1'); 
			var gw_red=$(this).prev().prev().children('.two').nextUntil().children('.choose_h1'); 
			var arr=[];
			var brr=[];
			var crr=[];
			var drr=[];
			var err=[];
			
			jQuery.each(ww_red, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				drr[i]=val.value;
				
			});
			
			jQuery.each(qw_red, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				err[i]=val.value;
				
			}); 
		
						
			jQuery.each(bw_red, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				arr[i]=val.value;
				
			}); 
		
			//console.log(arr);
			jQuery.each(sw_red, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				brr[i]=val.value;
				
			}); 
			
			//console.log(brr);
			
			jQuery.each(gw_red, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				crr[i]=val.value;
				
			}); 
			
			px(drr,drr.length);
			px(err,err.length);
			px(arr,arr.length);
			px(brr,brr.length);
			px(crr,crr.length);
			
			var ww_nn=drr.join(',');
			var qw_nn=err.join(',');
			var bw_nn=arr.join(',');
			var sw_nn=brr.join(',');
			var gw_nn=crr.join(',');
			var cp_num =ww_nn+'|'+qw_nn+'|'+ bw_nn+'|'+sw_nn+'|'+gw_nn;
			
			//alert(cp_num);
			var cp_now = $('.yes').text();
			var cp_pd = cp_now.indexOf("_");
			if(cp_pd>-1){
				var new_cp = cp_now.replace("_"+cp_num, "");
				var new_cp = new_cp.replace(cp_num, "");
			}else{
				var new_cp = cp_now.replace(cp_num, "");
			}
			var cp_now = $('.yes').text(new_cp);
			
			for(var p=0;p<drr.length;p++){
				red_w.eq(drr[p]).addClass("rxq").next().next().val(1);
			
			}
			
			for(var u=0;u<err.length;u++){
				red_q.eq(err[u]).addClass("rxq").next().next().val(1);
			
			}
										
			
			for(var i=0;i<arr.length;i++){
				red_b.eq(arr[i]).addClass("rxq").next().next().val(1);
			
			}
			
			for(var j=0;j<brr.length;j++){
				red_s.eq(brr[j]).addClass("rxq").next().next().val(1);
				
			}
			
			for(var k=0;k<crr.length;k++){
				red_g.eq(crr[k]).addClass("rxq").next().next().val(1);
				
			}

				/*从新记录各种颜色球的数量*/
			 var red_xq=jQuery('.r_ball.rxq').length;
			 jQuery('#red_num').val(red_xq);

		 	 var blue_xq=jQuery('.b_ball.bxq').length;
			 jQuery('#blue_num').val(blue_xq);
			 
			 var red_dd=jQuery('.rr_dan').length;
			 jQuery('#rr_dan').val(red_dd);
			 
			 var blue_dd=jQuery('.bb_dan').length;
			 jQuery('#bb_dan').val(blue_dd);
			 
		
		})
				
				
				
					//随时计算金额数
				if(ww_n<1 || qw_n<1 || bw_n<1 || sw_n<1 || gw_n<1){
					jQuery('.footer_font').html('共0元');
				}else{
						var money=parseInt(ww_n*qw_n*bw_n*sw_n*gw_n*2);
						var num= parseInt(money/2);
						jQuery('#money').val(money);
						jQuery('#tz').val(num);

					jQuery('.footer_font').html(function(){
						return "共"+money+"元";
					});
				}
				
			
				

	})
		
	
		
		//投注模式选择刷新
		jQuery('.mui-navigate-right').on('tap',function(){
			var red=jQuery('.r_ball');
			var blue=jQuery('.b_ball');
			red.removeClass('rxq');
			blue.removeClass('bxq');
			jQuery('.font_rdan').remove();
			jQuery('.r_ball').children('span').removeClass('font_num');
			jQuery('.font_bdan').remove();
			jQuery('.b_ball').children('span').removeClass('font_num');
			jQuery('.footer_font').html('共0元');
			jQuery('#red_num').val(0);
			jQuery('#blue_num').val(0);
			jQuery('#money').val(0);
			jQuery('#rr_dan').val(0);
			jQuery('#bb_dan').val(0);
		})
		

	
	
	
	
	
	//颜色进制转换
	function rgb2hex(rgb) {
	  	rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
	  	function hex(x) {
	    	return ("0" + parseInt(x).toString(16)).slice(-2);
	  	}
	 	return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
	}
	

	//绑定红球点击事件
		mui('#index_main1,#index_main2,#index_main3,#index_main4,#index_main5').on('tap','.r_ball',function(){
			var b=this.nextSibling.value;
			var c=jQuery(this).css('color');
			var a=rgb2hex(c);
			
			if(a=='#ff0000'){				
				jQuery(this).addClass('rxq').next().next().val(1);
				
			}else{
				jQuery(this).removeClass('rxq').next().next().val(0);
			}
						
			 var red_xq=jQuery('.r_ball.rxq').length;

			 jQuery('#red_num').val(red_xq);
				 			
		})
				

	
		//机选
		jQuery('.sj').on('tap',function(){
			var ww_red=jQuery('.ww_ball .r_ball');
			var qw_red=jQuery('.qw_ball .r_ball');
			var bw_red=jQuery('.bw_ball .r_ball');
			var sw_red=jQuery('.sw_ball .r_ball');
			var gw_red=jQuery('.gw_ball .r_ball');
			var arr=[];
			ww_red.removeClass('rxq');
			qw_red.removeClass('rxq');
			bw_red.removeClass('rxq');
			sw_red.removeClass('rxq');
			gw_red.removeClass('rxq');
			jQuery('#rr_dan').val(0);
			jQuery('.r_dan').val(0);
			jQuery('.font_rdan').remove();
			jQuery('.r_ball').children('span').removeClass('font_num');
			
			
			//console.log(arr);
	
			for(var n=0;n<5;n++){
				arr[n]= Math.floor(Math.random()*10);
			}
			
			ww_red.eq(arr[3]).addClass("rxq").next().next().val(1);
			qw_red.eq(arr[4]).addClass("rxq").next().next().val(1);
			bw_red.eq(arr[0]).addClass("rxq").next().next().val(1);
			sw_red.eq(arr[1]).addClass("rxq").next().next().val(1);	
			gw_red.eq(arr[2]).addClass("rxq").next().next().val(1);
			
			var red_xq=jQuery('.r_ball.rxq').length;
			jQuery('#red_num').val(red_xq);

		})
		
		
		
		//随机产生球
		function creatball(type){
			if(type=='z3'){
					 var num = new Array();
		        for(var i = 1; i <=2; i++){
		            var val =  Math.floor(Math.random()*10);
		            var isEqu = false;
		            for(var idx in num){
		                if(num[idx] == val){isEqu = true; break;}
		            }
		            if(isEqu){
		                i--;
		            }else{
		                num[num.length] = val;
		        }
	       			
	    	}
	    			return num;
		}else if(type=='z6'){
					 var num = new Array();
		        for(var i = 1; i <=3; i++){
		            var val =  Math.floor(Math.random()*10);
		            var isEqu = false;
		            for(var idx in num){
		                if(num[idx] == val){isEqu = true; break;}
		            }
		            if(isEqu){
		                i--;
		            }else{
		                num[num.length] = val;
		        }
	       			
	    	}
	    			return num;
		}
	}
		
		//冒泡排序
	function px(arr,len){
	for( var i=0;i<len;i++ ){
			for( var j=i+1;j<len;j++ ){
				var a = arr[i];
				if( arr[i]>arr[j] ){
					arr[i] = arr[j];
					arr[j] = a;
					
				}
			}
		}
	       
	}
	
</script>

<script type="text/javascript">
	jQuery('.jt_round').on('tap',function(){
		var v=jQuery('.jt_v').val();
		if(v == 0){
			jQuery('.jt_change').attr('src','wimages/jt_round_up.png');
			jQuery('.jt_v').val(1);
			jQuery('.history').attr('style','display:block');
		}else{
			jQuery('.jt_change').attr('src','wimages/jt_round_down.png');
			jQuery('.jt_v').val(0);
			jQuery('.history').attr('style','display:none');
		}
	})
</script>


<script>

	

/*获取历史开奖*/
mui.ajax(config[0].url+'/index.php/cpdlt',{
  data:{
  	type:'04',
  },
  dataType:'json',//服务器返回json格式数据
  type:'get',//HTTP请求类型
  timeout:10000,//超时时间设置为10秒；
  success:function(data){
    if(typeof data == "string") {var data = eval('('+data+')');}
    /*console.log(JSON.stringify(data));*/
   	if(data==false){
   		
   	}else{
   		var datalist = data.lists;
    	var html=[];
		
		for (var i=0;i<datalist.length;i++){
		//date_num = datalist[i].numbers;

        var numbers = datalist[i].numbers;//开奖号码
        var index_q = numbers.split(",");
       

        var w_numbers=[];
        for (l=0;l<index_q.length ;l++ ){
          w_numbers+= "<div class='min_rball'>"+index_q[l]+"</div>"; //分割后的字符输出 
        }
		html+="<div class='kj_all'><div class='q_num'>"+datalist[i].num+"</div><div class='k_num'>  "+w_numbers+" </div></div>";
		}
		$('.h_main').html(html);
   	}
   
    
  },
  error:function(xhr,type,errorThrown){
    //异常处理；
    //console.log(type);
	  switch (type) {
		  case "timeout":
			  mui.toast('连接超时，请重试');
			  break;
		  default:
			  mui.toast('请重试或重新登录');
	  }
  }
});




/*获取开奖停售时间*/
mui.ajax(config[0].url+'/index.php/cpdlt_endtime',{
  data:{
  	type:'04',
  },
  dataType:'json',//服务器返回json格式数据
  type:'get',//HTTP请求类型
  timeout:10000,//超时时间设置为10秒；
  success:function(data){
    if(typeof data == "string") {var data = eval('('+data+')');}
   /*console.log(JSON.stringify(data));*/
    /*console.log(arr[data]);*/ 
	var mydate = new Date(data);
	M = (mydate.getMonth()+1 < 10 ? '0'+(mydate.getMonth()+1) : mydate.getMonth()+1) + '-';
	D = mydate.getDate() ;
  jQuery('.e_time').html(M+D+"&nbsp;&nbsp;20:00");
  
  
  }, 
  error:function(xhr,type,errorThrown){
    //异常处理；
    //console.log(type);
	  switch (type) {
		  case "timeout":
			  mui.toast('连接超时，请重试');
			  break;
		  default:
			  mui.toast('请重试或重新登录');
	  }
  }
});







</script>



</html>