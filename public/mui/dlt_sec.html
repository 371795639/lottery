<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <title></title>
    <script src="js/mui.min.js"></script><script src="js/config.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <link href="css/test.css" rel="stylesheet"/>
    <script type="text/javascript" charset="utf-8">
      	mui.init({
      		
      	});
    </script>
     <script src="js/jquery-1.7.2.min.js"></script>
     <style>
     	.mui-bar .mui-btn {
    		padding: 4px 10px 5px;
    	}
    	.rxd{ background: red;}
    	.bxd{background: dodgerblue;}
    	.add_tb li{list-style-type: none;}
    	.mui-switch:before { top: -5px;}
    	.mui-switch.mui-active {
		    border-color: #007aff;
		    background-color: #007aff;
		}
     </style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">   
	    <div class="head_ready">
	    	 <a class=" bk mui-icon mui-icon-left-nav mui-pull-left"></a>
	    <h1 class="mui-title">确认选单</h1>
	    </div>
	</header>
	<input type="hidden" id='tz_bj' value='0' />
	
	<!--底部固定栏-->
	<nav id="footerBar" class="mui-bar mui-bar-tab">
		<div class="foot_ready">
			<!--<div id="bs" style="height: 44px;">
				<button type="button" id='jia' class="mui-btn mui-btn-primary">+</button>
				<div class='bb'><div class='bs_num'>1</div><div class='bs_font'>倍</div></div>
				<button type="button" class="mui-btn mui-btn-primary jian">-</button><div class="clear"></div>
			</div>
			<div class='clear'></div>
			<div id='total_money'>
				金额:<span class='total_mon'></span>元 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input id='zj' class='zjj' type="checkbox">追加(每注3元)
			</div>
			<div class='bs_btn'>
				<button type="button" id='sub' class="mui-btn mui-btn-danger">提交彩店</button><button type="button" id='save' class="mui-btn">保存</button>
				
			</div>
			<div class='bs_buttom_font'>
				
				<p class='p2'><input type="checkbox" checked="checked"  disabled="disabled"/>同意《希迈尔代购协议》并已经认可投注详情</p>
			</div>-->
			<div class='foot_list'>
				<div class='bs_buttom_font'>
					<p class='p2'><input type="checkbox" checked="checked"  disabled="disabled"/>同意《希迈尔代购协议》并已经认可投注详情</p>
				</div>
			</div>
			<div class='foot_list'>
				<div class='bs_fonts'>倍数：<span class='bs_nn'>1</span></div>
				<div class='bs_tb'>
					<button type="button" id='jia' class="mui-btn mui-btn-primary">+</button>
					<div class='bb'><div class='bs_num'>1</div></div>
					<button type="button" class="mui-btn mui-btn-primary jian">-</button>
					<div class="clear"></div>
				</div>
			</div>
			<div class='foot_list'>
				<div class='add_font'>
					追加(每注3元)：<span class='add_bj'>是</span>
				</div>
				<div class='add_tb' style='width:38%'>
		    		<li class="mui-table-view-cell" style='padding: 20px 15px;'>
		    			<input type="hidden" class='add_zj' value=''/>
						<div id='swi' class="mui-switch mui-active">
							<div class="mui-switch-handle zk"></div>
						</div>
					</li>
				</div>
			</div>
			<div class='foot_list'>
				<div class='zs_font'>
					注数：<span class='zs_num'></span>
				</div>
				<div class='mon_font' style='text-align: center;'>
					金额：&nbsp;&nbsp;&nbsp;<span class='total_mon' style='color:red'></span>&nbsp;&nbsp;元
				</div>
			</div>
			<div class='foot_list' style='height: 50px'>
				<button id='sub' type="button" class="mui-btn mui-btn-red" style='margin-left: 5%;width: 40%;height: 34px;margin-top: 8px;'>提交彩店</button>
				<button id='save' type="button" class="mui-btn mui-btn-blue" style='margin-left: 8%;width: 40%;height: 34px;margin-top: 8px;'>保存方案</button>
			</div>
		</div>
	</nav>
	
	<div class="mui-content">
	<div class="yes"></div>
	<div class='saj' style='display: none'></div>
	
	<div class="ready">
		   <div class='end_time'>
	    	<span><span class='now_qi'></span>&nbsp;&nbsp;<span class='e_time'>05-14 20:00</span>停售</span>	    
	    </div>
	    <div class="re_btn">
	    	<button type="button" id='hand' class="mui-btn mui-btn-primary mui-btn-outlined">手选号码</button>
	    	<button type="button" id='robot' class="mui-btn mui-btn-primary mui-btn-outlined">机选一注</button>
	    	<div class="clear"></div>
	    </div>
	    <div class='preview'></div>
	    
	</div>
	
</div>
	
</body>
<script type="text/javascript">
	mui('.foot_ready .mui-switch').each(function() { //循环所有toggle
				//toggle.classList.contains('mui-active') //可识别该toggle的开关状态	
				var a=this.classList.contains("mui-active");
				
				//console.log(this.previousSibling.previousSibling.value);
				if(a){
					 this.previousSibling.previousSibling.value='true';
				 
					
					  //b.innerText='是';
					  
					}else{
					  this.previousSibling.previousSibling.value='false';
					  
					  // b.innerText='否';
					 
				}
				/**
				 * toggle 事件监听
				 */
				//console.log(this.classList.contains('mui-active'));
				this.addEventListener('toggle', function(event) {
					//event.detail.isActive 可直接获取当前状态
					//this.parentNode.querySelector('input').value = (event.detail.isActive ? 'true' : 'false');			
					this.previousSibling.previousSibling.value=event.detail.isActive ? 'true' : 'false';
					
					if(event.detail.isActive){
						this.previousSibling.previousSibling.parentNode.parentNode.parentNode.childNodes[1].childNodes[1].innerText='是';
					}else{
						this.previousSibling.previousSibling.parentNode.parentNode.parentNode.childNodes[1].childNodes[1].innerText='否';
						
					}
					//console.log(event.detail.isActive);
					//console.log(toggle.classList.contains('mui-active'));
				});
			});
</script>
<script src="js/tk_check.js"></script>
<script type="text/javascript">
mui.plusReady(function(){
plus.webview.currentWebview();
});
jQuery('.head_ready,.ready,.foot_ready').attr('style','display:block');
reset();//进页面重置一下

	var url = window.location.search;
    var loc = url.substring(url.lastIndexOf('=')+1, url.length);
    var s_id=url.substring(url.lastIndexOf('?')+1,3);
    var r_id=url.substring(url.lastIndexOf('?')+1,4);
   	//console.log(save_id);	
    	if(s_id=='id'){
    		var save_id=url.substring(url.lastIndexOf('=')+1, url.length);
    		//console.log(save_id);
    		mui.ajax(config[0].url+'/index.php/save_detail',{
			 	data:{
			  		id:save_id,
			  	},
			  	dataType:'json',//服务器返回json格式数据
			  	type:'post',//HTTP请求类型
			  	timeout:10000,//超时时间设置为10秒；
			  	success:function(data){
				    if(typeof data == "string") {var data = eval('('+data+')');}
				 	console.log(data);
				 	var nb=[];
				 	for(var i=0;i<data.length;i++){
				 		
				 		var add = {'num':data[i].num,'z':data[i].zs_num,'dlt_types':data[i].c_types};
				 		nb.push(add);
				 	}
					
					window.localStorage.setItem('nb',JSON.stringify(nb));
					show();
					
					//$('#to_tz').val(data[0].save_z);
				 	jQuery('.zs_num').text(data[0].save_z)
				 	$('.total_mon').text(data[0].save_money);
				 	$('.bs_num').text(data[0].save_b);
				 	$('.bs_nn').text(data[0].save_b);
				 	if(data[0].save_add==0){
					 	$('#swi').removeClass('mui-active');
					 	$('.add_zj').val('false');
					 }
				 	
			  	},
			  	error:function(xhr,type,errorThrown){
				  	//异常处理；
				    //console.log(type);
					switch (type) {
						case "timeout":
							mui.toast('连接超时，请重试');
							break;
						default:
							mui.toast('请重试或重新登录');
					}
				}
			});
    	}else if(r_id=='rid'){
    		var oid=url.substring(url.lastIndexOf('=')+1, url.length);
    		mui.ajax(config[0].url+'/index.php/order_reset', {
	            data: {
	                order_id: oid,
	            },
	            dataType: 'json',//服务器返回json格式数据
	            type: 'post',//HTTP请求类型
	            timeout: 10000,//超时时间设置为10秒；
	            success: function (data) {
	                if (typeof data == "string") {
	                    var data = eval('(' + data + ')');
	                }
	                console.log(data);
	              var nb=[];
				 	for(var i=0;i<data.length;i++){
				 		
				 		var add = {'num':data[i].numbers,'z':data[i].num_z,'dlt_types':data[i].c_types};
				 		nb.push(add);
				 	}
				 	window.localStorage.setItem('nb',JSON.stringify(nb));
				 	show();
				 	
				 	$('.zs_num').text(data[0].order_z);
				 	$('.total_mon').text(data[0].order_money);
				 	$('.bs_num').text(data[0].order_b);
				 	$('.bs_nn').text(data[0].order_b);
				 	if(data[0].add==0){
					 	$('#swi').removeClass('mui-active');
					 	$('.add_zj').val('false');
					 }
					
	            },
	            error: function (xhr, type, errorThrown) {
	                //异常处理；
	                //console.log(type);
					switch (type) {
						case "timeout":
							mui.toast('连接超时，请重试');
							break;
						default:
							mui.toast('请重试或重新登录');
					}
	            }
	        });	
    	}else{
    		show();
    	}
    
    
    jQuery('.jt_back').on('tap',function(){
    	mui.openWindow({
		    url: 'index.html', 
		    id:'index',
		    createNew:true
		});
    })
    
	mui.ajax(config[0].url+'/index.php/cp_qi',{
			 	data:{
			  		types:'01',
			  	},
			  	dataType:'json',//服务器返回json格式数据
			  	type:'post',//HTTP请求类型
			  	timeout:10000,//超时时间设置为10秒；
			  	success:function(data){
				    if(typeof data == "string") {var data = eval('('+data+')');}
				    /*console.log(JSON.stringify(data));*/
				 	//console.log(data);
				 	$('.now_qi').text('大乐透'+data+'期');
			  	},
			  	error:function(xhr,type,errorThrown){
				  	//异常处理；
				    //console.log(type);
					switch (type) {
						case "timeout":
							mui.toast('连接超时，请重试');
							break;
						default:
							mui.toast('请重试或重新登录');
					}
				}
			});

/*提交彩店*/
jQuery('#sub').on('tap',function(){
	var cp_hm=window.localStorage.getItem('nb');
	var userid = window.localStorage.getItem("token");
	var order_money=jQuery('.total_mon').text();
	var total_tz=jQuery('.t_dz');
	var trr=[];
	jQuery.each(total_tz, function(i,val){
		/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
		console.log(i); //输出索引为0，1，2，3
		
		console.log(val.value); //输出value的值*/
		trr[i]=parseInt(val.value);
	
	}); 
	var to=eval(trr.join('+'));
	var numm=jQuery('.bs_num').text();
	var order_z=to;
	var order_b=jQuery('.bs_num').text();
	var user_mobile=window.localStorage.getItem("phone");
	var zjj='';
	var xhy=jQuery('.preview').html();
	window.localStorage.setItem('cp_hm',cp_hm);
	window.localStorage.setItem('to_money',order_money);
	window.localStorage.setItem('to_z',order_z);
	window.localStorage.setItem('to_b',order_b);
	//window.localStorage.setItem('xhy',xhy);
	//window.localStorage.setItem('order','yes');
	//window.localStorage.setItem('order_content',order_content);
	window.localStorage.setItem('cp_types','01');
	
	
	
			/*console.log(order_content);*/
	if(!userid){
		token_check(userid);
	}else{
		if(jQuery('.add_zj').val()=='true'){              
        		zjj=1;
        		window.localStorage.setItem('zjj',zjj);
        		if(order_money>30000){
			   		mui.toast('订单金额不得大于30000元');
			   		return;
			   	}
        	}else{
            	zjj=0;
            	window.localStorage.setItem('zjj',zjj);
            	if(order_money>20000){
			   		mui.toast('订单金额不得大于20000元');
			   		return;
			   	}
        }
        
        if(jQuery('.xh').length>5){
        		mui.toast('最多只能选5注');
       		}else{
        	  	if(order_b<0 || order_b==0 ){
			   		mui.toast('订单倍数不得小于1倍');
			   		return;
			   	}else if(order_money<1){
			   		mui.toast('订单金额不得小于1元');
			   		return;
			   	} 
			   	
			   	
			   	mui.ajax(config[0].url+'/index.php/cp_qi',{
				 	data:{
				  		types:'01',
				  	},
				  	dataType:'json',//服务器返回json格式数据
				  	type:'post',//HTTP请求类型
				  	timeout:10000,//超时时间设置为10秒；
				  	success:function(data){
					    if(typeof data == "string") {var data = eval('('+data+')');}
					    /*console.log(JSON.stringify(data));*/
					 	//console.log(data);
					 	window.localStorage.setItem('order_qi',data);
					 	mui.openWindow({
							url: 'order_1.html', 
							id:'order_1',
							createNew:true
						});
				  	},
				  	error:function(xhr,type,errorThrown){
					  	//异常处理；
					    //console.log(type);
						switch (type) {
							case "timeout":
								mui.toast('连接超时，请重试');
								break;
							default:
								mui.toast('请重试或重新登录');
						}
					}
				});
			   	
	        	
      		
        }
	
		
	}
	
	

	 
})
//userid判断
 function numbers_check(obj){    
        reg=/^[0-9]+.?[0-9]*$/;;    
        if(!reg.test(obj)){   
           return false;
        }else{   
           return true;
        }
}

	
	
	//判断数组是否相等
	function isContained(a, b){
	   var astr=a.sort().toString();
	   var bstr=b.sort().toString();
	   if(astr==bstr){
	   		return true;
	   }else{
	   		return false;
	   }
	}
	

	/*保存号码*/
	jQuery(document).on('tap','#save',function(){		
		var save_bj=$('.preview').children('.xh').children('.save_bj');
		var arr=[];
		for(var i=0;i<save_bj.length;i++){
			arr[i]=save_bj[i].value;
		}
		
		if(arr.length>1){
			var saj_now=arr.join(',');
		}else if(arr.length==1){
			var saj_now=arr[0];
		}
				
				
		var saj_old=$('.saj').text();
		
		if(saj_old=='' || saj_old==null || saj_old==undefined){
			//var cp_hm=jQuery('.yes').html();
			var cp_hm=window.localStorage.getItem('nb');
			var userid = window.localStorage.getItem("token");
			//var openid = window.localStorage.getItem("openid");
			var order_money=jQuery('.total_mon').text();
			var total_tz=jQuery('.t_dz');
			var trr=[];
			jQuery.each(total_tz, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				trr[i]=parseInt(val.value);
			
			}); 
			var to=eval(trr.join('+'));	
			var order_z=to;
			var order_b=jQuery('.bs_num').text();
			//var order_content=jQuery('.yes').text();
			var zjj='';
			var num_style=$('.preview').html();
			if(num_style==''){
				mui.toast('没有可以保存的号码!');
				return;
			}
			/*if(jQuery('#zj').is(":checked")){              
	        		zjj=1;
	       		
	        	}else{
	            	zjj=0;
	        }*/
	       	
	       	if($('.add_zj').val()=='true'){              
	        		zjj=1;
	       		
	        	}else{
	            	zjj=0;
	        }
	        	
	        mui.ajax(config[0].url+'/index.php/cp_qi',{
			 	data:{
			  		types:'01',
			  	},
			  	dataType:'json',//服务器返回json格式数据
			  	type:'post',//HTTP请求类型
			  	timeout:10000,//超时时间设置为10秒；
			  	success:function(data){
				    if(typeof data == "string") {var data = eval('('+data+')');}
				    /*console.log(JSON.stringify(data));*/
				 	//console.log(data);
				 	var order_qi=data;
				 	var cp_hm=window.localStorage.getItem('nb');
				 	mui.ajax(config[0].url+'/index.php/save_case',{
						data:{
							userid:userid,order_money:order_money,order_z:order_z,order_b:order_b,add:zjj,order_qi:order_qi,cp_types:'01',cp_hm:cp_hm,
						},
						dataType:'json',//服务器返回json格式数据
						type:'post',//HTTP请求类型
						timeout:10000,//超时时间设置为10秒；
						success:function(data){
							if(typeof data == "string") {
								var data = eval('('+data+')');
							}
							
							//console.log(data);
							$('.saj').text(saj_now);
							mui.toast('保存成功，可在个人中心查看记录');
							
						},
						error:function(xhr,type,errorThrown){
							//异常处理；
							//console.log(type);
							switch (type) {
								case "timeout":
									mui.toast('连接超时，请重试');
									break;
								default:
									mui.toast('请重试或重新登录');
							}
						}
					});
				 	
			  	},
			  	error:function(xhr,type,errorThrown){
				  	//异常处理；
				    //console.log(type);
					switch (type) {
						case "timeout":
							mui.toast('连接超时，请重试');
							break;
						default:
							mui.toast('请重试或重新登录');
					}
				}
			});
		}else{
			var brr=[];
			if(saj_old.indexOf(',')==-1){
				brr[0]=saj_old;
			}else if(saj_old.indexOf(',')>-1){
				brr=saj_old.split(',');
			}
			
			var a=isContained(brr,arr);
			if(a==true){
				mui.toast('方案已保存，请勿重复保存');
			}else{
				var cp_hm=window.localStorage.getItem('nb');
				var userid = window.localStorage.getItem("token");
				//var openid = window.localStorage.getItem("openid");
				var order_money=jQuery('.total_mon').text();
				var total_tz=jQuery('.t_dz');
				var trr=[];
				jQuery.each(total_tz, function(i,val){
					/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
					console.log(i); //输出索引为0，1，2，3
					
					console.log(val.value); //输出value的值*/
					trr[i]=parseInt(val.value);
				
				}); 
				var to=eval(trr.join('+'));	
				var order_z=to;
				var order_b=jQuery('.bs_num').text();
				//var order_content=jQuery('.yes').text();
				var zjj='';
				var num_style=$('.preview').html();
				if(num_style==''){
					mui.toast('没有可以保存的号码!');
					return;
				}
				if(jQuery('.add_zj').val()=='true'){              
		        		zjj=1;
		       		
		        	}else{
		            	zjj=0;
		        }
		        	
		        mui.ajax(config[0].url+'/index.php/cp_qi',{
				 	data:{
				  		types:'01',
				  	},
				  	dataType:'json',//服务器返回json格式数据
				  	type:'post',//HTTP请求类型
				  	timeout:10000,//超时时间设置为10秒；
				  	success:function(data){
					    if(typeof data == "string") {var data = eval('('+data+')');}
					    /*console.log(JSON.stringify(data));*/
					 	//console.log(data);
					 	var order_qi=data;
					 	var cp_hm=window.localStorage.getItem('nb');
					 	mui.ajax(config[0].url+'/index.php/save_case',{
							data:{
								userid:userid,order_money:order_money,order_z:order_z,order_b:order_b,add:zjj,order_qi:order_qi,cp_types:'01',cp_hm:cp_hm,
							},
							dataType:'json',//服务器返回json格式数据
							type:'post',//HTTP请求类型
							timeout:10000,//超时时间设置为10秒；
							success:function(data){
								if(typeof data == "string") {
									var data = eval('('+data+')');
								}
								
								//console.log(data);
								$('.saj').text(saj_now);
								mui.toast('保存成功，可在个人中心查看记录');
								
							},
							error:function(xhr,type,errorThrown){
								//异常处理；
								//console.log(type);
								switch (type) {
									case "timeout":
										mui.toast('连接超时，请重试');
										break;
									default:
										mui.toast('请重试或重新登录');
								}
							}
						});
					 	
				  	},
				  	error:function(xhr,type,errorThrown){
					  	//异常处理；
					    //console.log(type);
						switch (type) {
							case "timeout":
								mui.toast('连接超时，请重试');
								break;
							default:
								mui.toast('请重试或重新登录');
						}
				
					}
				});
			}
		}
	})
	
function show(){
	var num=JSON.parse(window.localStorage.getItem('nb'));
	//var num=JSON.parse(nb);
	console.log(num);
	var timestamp=new Date().getTime();
	var order_b = window.localStorage.getItem('to_b');
		if(order_b){
			$('.bs_nn').text(order_b);
			$('.bs_num').text(order_b);
		}
	if(num){
		for(var i=0;i<num.length;i++){
			var b='';
			var a='';
			var c='';
			var d='';
			var e='';
			var f='';
			var g='';
			var arr=[];
			var arr=num[i].num.split('|');
			if(num[i].dlt_types==1 ){
				var brr=[];
				var crr=[];
				brr=arr[0].split(',');
				crr=arr[1].split(',');
				for(var k=0;k<brr.length;k++){			    
					a+="<div class='choose_rball rxq'>"+brr[k]+"<input class='choose_h1' type='hidden' value="+brr[k]+"></div>";		
				}
				
				for(var j=0;j<crr.length;j++){
					b+="<div class='choose_bball bxq'>"+crr[j]+"<input class='choose_h2' type='hidden' value="+crr[j]+"></div>";
				}
				
				b=b+"<div class='clear'></div>";
				c=a+b;
				d="<div class='xh'><div class='xh_close'>x</div><div class='xhm'>"+c+"</div><input class='t_dz' type='hidden' value='"+num[i].z+"'><div class='rjt'>></div><input class='save_bj' type='hidden' value='"+timestamp+"'><div class='clear'></div></div>";
				jQuery('.preview').append(d);
	
			}else if(num[i].dlt_types==2 ){
				var brr=[];
				var crr=[];
				var drr=[];
				var err=[];
				brr=arr[0].split(';');
				err=arr[1].split(',');
				drr=brr.pop().split(',');
				for( var k=0;k<brr.length;k++){
					a+="<div class='choose_rball rxd rd'>"+brr[k]+"<input class='choose_h1' type='hidden' value="+brr[k]+"></div>";
				}
				a="<div style='float:left;margin-bottom: 12px;'>[胆:</div>"+a+"<div style='float:left;margin-bottom: 12px;'>]</div>";
				
				for( var j=0;j<drr.length;j++){
					b+="<div class='choose_rball rxq'>"+drr[j]+"<input class='choose_h1' type='hidden' value="+drr[j]+"></div>";
				}
				
				for(var h=0;h<err.length;h++){
					c+="<div class='choose_bball bxq'>"+err[h]+"<input class='choose_h2' type='hidden' value="+err[h]+"></div>";
				}
				
				d=a+b+c+"<div class='clear'></div>";
				e="<div class='xh'><div class='xh_close'>x</div><div class='xhm'>"+d+"</div><input class='t_dz' type='hidden' value='"+num[i].z+"'><div class='rjt'>></div><input class='save_bj' type='hidden' value='"+timestamp+"'><div class='clear'></div></div>";
					
				jQuery('.preview').append(e);
				
				
			}else if(num[i].dlt_types==3 ){
				var brr=[];
				var crr=[];
				var drr=[];
				var err=[];
				brr=arr[0].split(';');
				crr=arr[1].split(';');
				drr=brr.pop().split(',');
				err=crr.pop().split(',');
				for( var k=0;k<brr.length;k++){
					a+="<div class='choose_rball rxd rd'>"+brr[k]+"<input class='choose_h1' type='hidden' value="+brr[k]+"></div>";
				}
				a="<div style='float:left;margin-bottom: 12px;'>[胆:</div>"+a+"<div style='float:left;margin-bottom: 12px;'>]</div>";
				
				for( var j=0;j<drr.length;j++){
					b+="<div class='choose_rball rxq'>"+drr[j]+"<input class='choose_h1' type='hidden' value="+drr[j]+"></div>";
				}
				
				for(var h=0;h<crr.length;h++){
					c+="<div class='choose_bball bxd bd'>"+crr[h]+"<input class='choose_h2' type='hidden' value="+crr[h]+"></div>";
				}
					c="<div style='float:left;margin-bottom: 12px;'>[胆:</div>"+c+"<div style='float:left;margin-bottom: 12px;'>]</div>";
					
				for( var p=0;p<err.length;p++){
					d+="<div class='choose_bball bxq'>"+err[p]+"<input class='choose_h2' type='hidden' value="+err[p]+"></div>";
				}
				
				e=a+b+c+d+"<div class='clear'></div>";
				f="<div class='xh'><div class='xh_close'>x</div><div class='xhm'>"+e+"</div><input class='t_dz' type='hidden' value='"+num[i].z+"'><div class='rjt'>></div><input class='save_bj' type='hidden' value='"+timestamp+"'><div class='clear'></div></div>";

				jQuery('.preview').append(f);
				
			}else if(num[i].dlt_types==4 ){
				var brr=[];
				var crr=[];
				var drr=[];
				var err=[];
				brr=arr[0].split(',');
				crr=arr[1].split(';');
				drr=crr.pop().split(',');
				for(var k=0;k<brr.length;k++){			    
					a+="<div class='choose_rball rxq'>"+brr[k]+"<input class='choose_h1' type='hidden' value="+brr[k]+"></div>";		
				}
				
				for(var h=0;h<crr.length;h++){
					b+="<div class='choose_bball bxd bd'>"+crr[h]+"<input class='choose_h2' type='hidden' value="+crr[h]+"></div>";
				}
					b="<div style='float:left;margin-bottom: 12px;'>[胆:</div>"+b+"<div style='float:left;margin-bottom: 12px;'>]</div>";
					
				for( var p=0;p<drr.length;p++){
					c+="<div class='choose_bball bxq'>"+drr[p]+"<input class='choose_h2' type='hidden' value="+drr[p]+"></div>";
				}
				
				e=a+b+c+"<div class='clear'></div>";
				f="<div class='xh'><div class='xh_close'>x</div><div class='xhm'>"+e+"</div><input class='t_dz' type='hidden' value='"+num[i].z+"'><div class='rjt'>></div><input class='save_bj' type='hidden' value='"+timestamp+"'><div class='clear'></div></div>";

				jQuery('.preview').append(f);
			}
		}
	}
}



	
	
	
	

	
//求两个数组差集
function minus(arr1,arr2){
    var arr3 = [];
    for (var i = 0; i < arr1.length; i++) {
                        var flag = true;
                        for (var j = 0; j < arr2.length; j++) {
                            if (arr2[j] == arr1[i]) {
                                flag = false;
                            }
                        }
                        if (flag) {
                            arr3.push(arr1[i]);
                        }
                    }
return arr3;
}

	
	/*机选一注*/
	jQuery('#robot').on('tap',function(){
		var total_num=$('.preview').children().length;
			//alert(total_num);
		if(total_num==5){
			mui.toast('最多只能选五注');return;
		}
			var arr=creatball('red');
			var brr=creatball('blue');
			var timestamp=new Date().getTime();
			var t_num=1;
			px(arr,5);//进行排序
			px(brr,2);//进行排序
			for(var j=0;j<5;j++){
				if(arr[j]<10){
					arr[j]='0'+arr[j];
				}
			}
			
			for(var k=0;k<2;k++){
				if(brr[k]<10){
					brr[k]='0'+brr[k];
				}
			}
			
			var b='';
			var a='';
			var c='';
			var d='';
			for(var i=1;i<=7;i++){
							    
				if(i<=5){
					a+="<div class='choose_rball rxq'>"+arr[i-1]+"<input class='choose_h1' type='hidden' value="+arr[i-1]+"></div>";
					

				}else{
					
					b+="<div class='choose_bball bxq'>"+brr[i-6]+"<input class='choose_h2' type='hidden' value="+brr[i-6]+"></div>";

						
				}					
		}		
		
			cp_num = arr+'|'+brr;
			var nb=window.localStorage.getItem('nb');
				//console.log(nb);
				if(nb!=''){
					var num=JSON.parse(nb);
					var add = {'num':cp_num,'z':t_num,'dlt_types':'1'};
					num.push(add);
					window.localStorage.setItem('nb',JSON.stringify(num));
				}else{
					var nb=[];
					var add = {'num':cp_num,'z':t_num,'dlt_types':'1'};
					nb.push(add);
					
					window.localStorage.setItem('nb',JSON.stringify(nb));
				}
			
		c=a+b+"<div class='clear'></div>";
		d="<div class='xh'><div class='xh_close'>x</div><div class='xhm'>"+c+"</div><input class='t_dz' type='hidden' value='"+t_num+"'><div class='rjt'>></div><input class='save_bj' type='hidden' value='"+timestamp+"'><div class='clear'></div></div>";
		
		
		jQuery('.preview').append(d);
	})
	
	/*初始化选号页面*/
	function reset(){
			var red=jQuery('.r_ball');
			var blue=jQuery('.b_ball');
			red.removeClass('rxq').removeClass('rr_dan').removeClass('rd');
			blue.removeClass('bxq').removeClass('dd_dan').removeClass('bd');
			jQuery('.font_rdan').remove();
			jQuery('.r_ball').children('span').removeClass('font_num');
			jQuery('.font_bdan').remove();
			jQuery('.b_ball').children('span').removeClass('font_num');
			jQuery('.footer_font').html('至少选5红球2蓝球');
			jQuery('#red_num').val(0);
			jQuery('#blue_num').val(0);
			jQuery('#money').val(0);
			jQuery('#rr_dan').val(0);
			jQuery('#bb_dan').val(0);
			jQuery('#tz').val(0);
			jQuery('.r_dan').val(0);
			jQuery('.b_dan').val(0);
			$('.saj').text();
			
	}
	
	
	
	/*返回选号画面*/
	jQuery('#hand,.bk').on('tap',function(){
		mui.openWindow({
			url:'dlt.html',
			id:'dlt',
			createNew:true
		})
	})
	
				//倍数
				jQuery('#jia').on('tap',function(){
										
						var numm=parseInt(jQuery('.bs_num').text());											
						numm++;
						if(numm>99){
							numm=99;
						}
						jQuery('.bs_num').text(numm);
						jQuery('.bs_nn').text(numm);
								
				})
				
				jQuery('.jian').on('tap',function(){
										
						var numm=parseInt(jQuery('.bs_num').text());											
						numm--;
						if(numm<1){
							numm=1;	
						}
						jQuery('.bs_num').text(numm);
						jQuery('.bs_nn').text(numm);
								
				})
				
				/*删除选中号*/
				jQuery(document).on('tap','.xh_close',function(){
	
					var nn=window.localStorage.getItem('nb');
					var space=$(this).parent().prevUntil().length;
					var nnm=JSON.parse(nn);
					nnm.splice(space,1);
					window.localStorage.setItem('nb',JSON.stringify(nnm));
					//console.log(nnm);
					
					jQuery(this).parent().remove();

				})
				
				/*修改选中号*/
				jQuery(document).on('tap','.rjt',function(){
					var nn=window.localStorage.getItem('nb');
					var space=$(this).parent().prevUntil().length;
					var nnm=JSON.parse(nn);
					nnm[space].sp=space;
					//console.log(nnm[space]);
					var up_num=nnm[space];
					//console.log(up_num)
					window.localStorage.setItem('update_num',JSON.stringify(up_num));
					window.location.href='dlt.html?up=update';
				})
				
				function money_show(){
						/*预览页面金额计算*/
					var total_tz=jQuery('.t_dz');
					var trr=[];
					jQuery.each(total_tz, function(i,val){
						/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
						console.log(i); //输出索引为0，1，2，3
						
						console.log(val.value); //输出value的值*/
						trr[i]=parseInt(val.value);
					
					}); 
					var to=eval(trr.join('+'));
					var numm=jQuery('.bs_num').text();
					if(jQuery('.add_zj').val()=='true'){
						var t_money=to*3*numm;
						jQuery('.total_mon').text(t_money);
							
							
						}else{
							var t_money=to*2*numm;
							jQuery('.total_mon').text(t_money);
							
						}
					var t_money=to*2*numm;
					//jQuery('.total_mon').text(t_money);
					$('.zs_num').text(to);
				}
				money_show();
				
					
				
				
				
				
		jQuery(document).on('tap',function(){
				 tz_bj=jQuery('#tz_bj').val();
				var red_n=parseInt(jQuery('#red_num').val());
				var blue_n=parseInt(jQuery('#blue_num').val());
				var mo=jQuery('#money').val();
				var rdan_num=parseInt(jQuery('#rr_dan').val()); 
				var bdan_num=parseInt(jQuery('#bb_dan').val()); 
				var re=parseInt(red_n-rdan_num);
				var blu=parseInt(blue_n-bdan_num);
				
				
				/*预览页面金额计算*/
				var total_tz=jQuery('.t_dz');
				var trr=[];
				jQuery.each(total_tz, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				trr[i]=parseInt(val.value);
				
			}); 
				 var to=eval(trr.join('+'));
				 var numm=jQuery('.bs_num').text();
				 jQuery('#to_tz').val(to);
				  jQuery('.zs_num').text(to);
				 //alert(to)
				 if(to==undefined || to==''){
				 	to = 0;
				 }
				 	
					if(jQuery('.add_zj').val()=='true'){
							var t_money=to*3*numm;
							jQuery('.total_mon').text(t_money);
							
							
						}else{
							var t_money=to*2*numm;
							jQuery('.total_mon').text(t_money);
							
						}
						
					jQuery('.zk').on('click',function(){
						
						if(jQuery('.add_zj').val()=='true'){
							var t_money=to*3*numm;
							jQuery('.total_mon').text(t_money);
							
							
						}else{
							var t_money=to*2*numm;
							jQuery('.total_mon').text(t_money);
							
						}
						
					})
					
				
				
				
				
				
					/*修改选中号*/
		jQuery('.rjtt').on('tap',function(){
			jQuery(this).addClass('update');
			var r_ba=jQuery(this).prev().prev().children('.choose_rball.rxq').children('.choose_h1');
			var r_badan=jQuery(this).prev().prev().children('.rd').children('.choose_h1');
			var r_dd=r_badan.length;
			console.log(r_badan);
			var b_badan=jQuery(this).prev().prev().children('.bd').children('.choose_h2');
			var b_dd=b_badan.length;
			/*console.log(b_dd);*/
			var b_ba=jQuery(this).prev().prev().children('.choose_bball').children('.choose_h2');
			var r_nu=parseInt(jQuery('#red_num').val());
			var b_nu=parseInt(jQuery('#blue_num').val());
			var rr_d=parseInt(jQuery('#rr_dan').val());
			jQuery('.choose,.foot_choose,.head_choose').attr('style','display:block');
			jQuery('.head_ready,.ready,.foot_ready').attr('style','display:none');
			reset();//调用初始化选号页面
			
			var red=jQuery('.r_ball');
			var blue=jQuery('.b_ball');
			
			var arr=[];
			var brr=[];
			var crr=[];
			var drr=[];
		
						
			jQuery.each(r_ba, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				arr[i]=val.value;
				
			}); 
		
			
			jQuery.each(b_ba, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				brr[i]=val.value;
				
			}); 
			
			jQuery.each(r_badan, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				crr[i]=val.value;
				
			}); 
			console.log(crr);
			
			jQuery.each(b_badan, function(i,val){
				/*console.log(val); //输出[object HTMLInputElement]，因为它是一个表单元素。
				console.log(i); //输出索引为0，1，2，3
				
				console.log(val.value); //输出value的值*/
				drr[i]=val.value;
				
			}); 
			/*console.log(drr);*/
			
			
			
			if( r_dd == 0 && b_dd == 0 ){
				for(var i=0;i<r_nu;i++){
					red.eq(arr[i]-1).addClass("rxq").next().next().val(1);
				
				}
				
				for(var j=0;j<b_nu;j++){
					blue.eq(brr[j]-1).addClass("bxq").next().next().val(1);
					
				}
				
				
			}else if( r_dd>0 && b_dd==0 ){
				var rrcj=minus(arr,crr);
				var rrcj_len=rrcj.length;
				for(var i=0;i<rrcj_len;i++){
					red.eq(rrcj[i]-1).addClass("rxq").next().next().val(1);
				
				}
				
				for(var h=0;h<r_dd;h++){				
					red.eq(crr[h]-1).addClass("rxq rr_dan").html("<span class='font_num'>"+crr[h]+"</span><span class='font_rdan'>胆</span>").next().next().val(2);
			
					
				}
				
				for(var j=0;j<b_nu;j++){
					blue.eq(brr[j]-1).addClass("bxq").next().next().val(1);
					
				}
				
			}else if( r_dd == 0 && b_dd>0){
				var bbcj=minus(brr,drr);
				var bbcj_len=bbcj.length;
				for(var i=0;i<r_nu;i++){
					red.eq(arr[i]-1).addClass("rxq").next().next().val(1);
				
				}
				
								
				for(var j=0;j<bbcj_len;j++){
					blue.eq(bbcj[j]-1).addClass("bxq").next().next().val(1);
					
				}
				
				for(var h=0;h<b_dd;h++){				
					blue.eq(drr[h]-1).addClass("bxq bb_dan").html("<span class='font_num'>"+drr[h]+"</span><span class='font_rdan'>胆</span>").next().next().val(2);
			
					
				}
			
			}else if( r_dd>0 && b_dd>0){
				var rrcj=minus(arr,crr);
				var rrcj_len=rrcj.length;
				var bbcj=minus(brr,drr);
				var bbcj_len=bbcj.length;
				for(var i=0;i<rrcj_len;i++){
					red.eq(rrcj[i]-1).addClass("rxq").next().next().val(1);
				
				}
				
				for(var h=0;h<r_dd;h++){				
					red.eq(crr[h]-1).addClass("rxq rr_dan").html("<span class='font_num'>"+crr[h]+"</span><span class='font_rdan'>胆</span>").next().next().val(2);
			
					
				}
				
				for(var j=0;j<bbcj_len;j++){
					blue.eq(bbcj[j]-1).addClass("bxq").next().next().val(1);
					
				}
				
				for(var h=0;h<b_dd;h++){				
					blue.eq(drr[h]-1).addClass("bxq bb_dan").html("<span class='font_num'>"+drr[h]+"</span><span class='font_rdan'>胆</span>").next().next().val(2);
			
					
				}
			}
				
				/*从新记录各种颜色球的数量*/
			 var red_xq=jQuery('.r_ball.rxq').length;
			 jQuery('#red_num').val(red_xq);

		 	 var blue_xq=jQuery('.b_ball.bxq').length;
			 jQuery('#blue_num').val(blue_xq);
			 
			 var red_dd=jQuery('.rr_dan').length;
			 jQuery('#rr_dan').val(red_dd);
			 
			 var blue_dd=jQuery('.bb_dan').length;
			 jQuery('#bb_dan').val(blue_dd);
			 
		
		})
				
				
				if( tz_bj ==0){
					//随时计算金额数
				if(red_n<5 || blue_n<2){
					jQuery('.footer_font').html('至少选5红球2蓝球');
				}else{

						var money=parseInt(su(5,red_n)*su(2,blue_n)*2);
						var num= parseInt(money/2);
						jQuery('#money').val(money);
						jQuery('#tz').val(num);

					jQuery('.footer_font').html(function(){
						return red_n+"红球"+blue_n+"蓝球，共"+money+"元";
					});
				}
				
			}else if( tz_bj ==1 ){
				if(red_n<5 || blue_n<2){
					jQuery('.footer_font').html('至少选5红球2蓝球');
				}else{
				if(rdan_num>0 || bdan_num>0){
					
					var money=parseInt(rd(rdan_num,re)*bd(bdan_num,blu)*2);
					var num= parseInt(money/2);
					jQuery('#money').val(money);
					jQuery('#tz').val(num);
					
				jQuery('.footer_font').html(function(){
						return red_n+"红球"+blue_n+"蓝球，共"+money+"元";
					});
				}else{
					var money=parseInt(su(5,red_n)*su(2,blue_n)*2);
						var num= parseInt(money/2);
						jQuery('#money').val(money);
						jQuery('#tz').val(num);

					jQuery('.footer_font').html(function(){
						return red_n+"红球"+blue_n+"蓝球，共"+money+"元";
					});
				}
					
				
			}
		}
				

	})
		
	
		
		//投注模式选择刷新
		jQuery('.mui-navigate-right').on('tap',function(){
			var red=jQuery('.r_ball');
			var blue=jQuery('.b_ball');
			red.removeClass('rxq');
			blue.removeClass('bxq');
			jQuery('.font_rdan').remove();
			jQuery('.r_ball').children('span').removeClass('font_num');
			jQuery('.font_bdan').remove();
			jQuery('.b_ball').children('span').removeClass('font_num');
			jQuery('.footer_font').html('至少选5红球2蓝球');
			jQuery('#red_num').val(0);
			jQuery('#blue_num').val(0);
			jQuery('#money').val(0);
			jQuery('#rr_dan').val(0);
			jQuery('#bb_dan').val(0);
		})
		

	
	
	
	
	
	
	//颜色进制转换
	function rgb2hex(rgb) {
		  rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
		  function hex(x) {
		    return ("0" + parseInt(x).toString(16)).slice(-2);
		  }
		  return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
		}
	

	//绑定红球点击事件
				mui('#index_main1').on('tap','.r_ball',function(){
					var b=this.nextSibling.value;
					var c=jQuery(this).css('color');
					var a=rgb2hex(c);
					
					if( tz_bj == 0 ){
						if(a=='#ff0000'){				
							jQuery(this).addClass('rxq').next().next().val(1);
							
						}else{
							jQuery(this).removeClass('rxq').next().next().val(0);
						}
									
						 var red_xq=jQuery('.r_ball.rxq').length;
			
						 jQuery('#red_num').val(red_xq);
						 
					}else if( tz_bj == 1 ){
						var r_dan=this.nextSibling.nextSibling.value;
						if( r_dan == 0){
							jQuery(this).addClass('rxq');
							jQuery(this).next().next().val(1);
							
							}else if( r_dan == 1 ){
							
								
								var rdan_num=jQuery('#rr_dan').val();
								if( rdan_num == '' || rdan_num == 0 || rdan_num < 4  ){
									var d=jQuery(this).next().val();
									jQuery(this).addClass('rr_dan');
									jQuery(this).html("<span class='font_num'>"+d+"</span><span class='font_rdan'></span>");
									jQuery(this).next().next().val(2);
								}else if( rdan_num == 4 ){
									var d=jQuery(this).next().val();
									jQuery(this).removeClass('rxq');
									jQuery(this).removeClass('rr_dan');
									jQuery(this).next().next().val(0);
									jQuery(this).html("<span>"+d+"</span>");
								}
								
							
							}else if( r_dan == 2 ){
							
								var d=jQuery(this).next().val();
								jQuery(this).removeClass('rxq');
								jQuery(this).removeClass('rr_dan');
								jQuery(this).next().next().val(0);
								jQuery(this).html("<span>"+d+"</span>");
							}
					}
						 var red_x=jQuery('.r_ball.rxq').length;
			
						 jQuery('#red_num').val(red_x);
						var red_dan=jQuery('.rr_dan').length;			
						 	jQuery('#rr_dan').val(red_dan);
					
				})
				
			//绑定蓝球点击事件
				mui('#index_main2').on('tap','.b_ball',function(){
					var b=this.nextSibling.value;
					var c=jQuery(this).css('color');
					var a=rgb2hex(c);
					
					if( tz_bj == 0){
						if(a == '#1e90ff'){				
								jQuery(this).addClass('bxq');
			
						}else{					
								jQuery(this).removeClass('bxq');
						}				
							var blue_xq=jQuery('.b_ball.bxq').length;
							jQuery('#blue_num').val(blue_xq);
					}else if( tz_bj == 1){
							var b_dan=this.nextSibling.nextSibling.value;
						if( b_dan == 0){
							jQuery(this).addClass('bxq');
							jQuery(this).next().next().val(1);
							
						}else if( b_dan == 1 ){
							
							var bdan_num=jQuery('#bb_dan').val();
							if( bdan_num == '' || bdan_num == 0  ){
								var d=jQuery(this).next().val();
								jQuery(this).addClass('bb_dan');
								jQuery(this).html("<span class='font_num'>"+d+"</span><span class='font_bdan'>胆</span>");
								jQuery(this).next().next().val(2);
							}else if( bdan_num == 1){
								var d=jQuery(this).next().val();
								jQuery(this).removeClass('bxq');
								jQuery(this).next().next().val(0);
								jQuery(this).html("<span>"+d+"</span>");
							}
						
							
						}else if( b_dan == 2 ){
							var d=jQuery(this).next().val();
							jQuery(this).removeClass('bxq');
							jQuery(this).removeClass('bb_dan');
							jQuery(this).next().next().val(0);
							jQuery(this).html("<span>"+d+"</span>");
						}
					}
						var blue_dan=jQuery('.bb_dan').length;			
						 	jQuery('#bb_dan').val(blue_dan);
						var blue_x=jQuery('.b_ball.bxq').length;			
						 	jQuery('#blue_num').val(blue_x);
					
				})
				
	
		//无胆拖排列组合计算
		/*红色球，m=5,n代表选红球个数*/
		/*蓝色球，m=2,n代表选蓝球个数*/
		function su(m,n){
			var a=1;
			var b=1;
			var c=1;
			if(m==n){
				return 1;
			}else{
				for(var i=m;i>0;i--){
					 a*=i;
				}

				for(var j=n;j>0;j--){
					b*=j;
				}

				for(var k=n-m;k>0;k--){
					c*=k;
				}

				var su=b/(a*c);
				return su;
			}
											
		}
		
		//有胆拖排列组合计算
		/*m代表胆的个数，n代表除胆之外的球个数*/
		/*红球中，m>=0 && m<=4*/
		/*蓝球中，m>=0 && m<=2*/
		function rd(m,n){
			var a=1;
			var b=1;
			var c=1;
			
			for(var i=5-m;i>0;i--){
				a*=i;
			}
			
			for(var j=n;j>0;j--){
				b*=j;
			}
			
			for(var k=n-5+m;k>0;k--){
				c*=k;
			}
			
			var dan=b/(a*c);
			return dan;
						
		}
		
		function bd(m,n){
			var a=1;
			var b=1;
			var c=1;
			
			for(var i=2-m;i>0;i--){
				a*=i;
			}
			
			for(var j=n;j>0;j--){
				b*=j;
			}
			
			for(var k=n-2+m;k>0;k--){
				c*=k;
			}
			
			var dan=b/(a*c);
			return dan;
						
		}

	
		
	
		//机选
		jQuery('.sj').on('tap',function(){
			var red=jQuery('.r_ball');
			var blue=jQuery('.b_ball');
			var arr=creatball('red');
			var brr=creatball('blue');
			red.removeClass('rxq');
			blue.removeClass('bxq');
			red.removeClass('rr_dan');
			blue.removeClass('bb_dan');
			jQuery('#rr_dan').val(0);
			jQuery('#bb_dan').val(0);
			jQuery('.r_dan').val(0);
			jQuery('.b_dan').val(0);
			jQuery('.font_rdan').remove();
			jQuery('.r_ball').children('span').removeClass('font_num');
			jQuery('.font_bdan').remove();
			jQuery('.b_ball').children('span').removeClass('font_num');
			px(arr,5);//进行排序
			px(brr,2);//进行排序
			
			
			for(var i=0;i<5;i++){
				red.eq(arr[i]-1).addClass("rxq").next().next().val(1);
				
			}

			for(var j=0;j<2;j++){
				blue.eq(brr[j]-1).addClass("bxq").next().next().val(1);
				
			}

			 var red_xq=jQuery('.r_ball.rxq').length;
			 jQuery('#red_num').val(red_xq);

		 	var blue_xq=jQuery('.b_ball.bxq').length;
			jQuery('#blue_num').val(blue_xq);
		})
		
		
		
		//随机产生球
		function creatball(color){
			if(color=='red'){
					 var num = new Array();
		        for(var i = 1; i <=5; i++){
		            var val =  Math.ceil(Math.random()*(34)+1);
		            var isEqu = false;
		            for(var idx in num){
		                if(num[idx] == val){isEqu = true; break;}
		            }
		            if(isEqu){
		                i--;
		            }else{
		                num[num.length] = val;
		        }
	       			
	    	}
	    			return num;
		}else{
				var num = new Array();
		        for(var i = 1; i <=2; i++){
		            var val =  Math.ceil(Math.random()*(11)+1);
		            var isEqu = false;
		            for(var idx in num){
		                if(num[idx] == val){isEqu = true; break;}
		            }
		            if(isEqu){
		                i--;
		            }else{
		                num[num.length] = val;
		        }
	       			
	    	}
	    		return num;
		}
	}
		
		//冒泡排序
	function px(arr,len){
	for( var i=0;i<len;i++ ){
			for( var j=i+1;j<len;j++ ){
				var a = arr[i];
				if( arr[i]>arr[j] ){
					arr[i] = arr[j];
					arr[j] = a;
					
				}
			}
		}
	       
	}
	
</script>

<script type="text/javascript">
	jQuery('.jt_round').on('tap',function(){
		var v=jQuery('.jt_v').val();
		if(v == 0){
			jQuery('.jt_change').attr('src','wimages/jt_round_up.png');
			jQuery('.jt_v').val(1);
			jQuery('.history').attr('style','display:block');
		}else{
			jQuery('.jt_change').attr('src','wimages/jt_round_down.png');
			jQuery('.jt_v').val(0);
			jQuery('.history').attr('style','display:none');
		}
	})
</script>


<script>

	



/*获取开奖时间*/
mui.ajax(config[0].url+'/index.php/cpdlt_time',{
  data:{
  },
  dataType:'json',//服务器返回json格式数据
  type:'get',//HTTP请求类型
  timeout:10000,//超时时间设置为10秒；
  success:function(data){
    if(typeof data == "string") {var data = eval('('+data+')');}
   /* console.log(JSON.stringify(data));*/
    var arr=['日','一','二','三','四','五','六'];
    /*console.log(arr[data]);*/
    	if(data==0 ||data==2 ||data==5){
            jQuery('.kjt').text("星期"+arr[data+1]+"20:00截止，20:30开奖");
        }else if(data==4){
             jQuery('.kjt').text("星期"+arr[data+2]+"20:00截止，20:30开奖");
        }else{
            jQuery('.kjt').text("星期"+arr[data]+"20:00截止，20:30开奖");
        }
  },
  error:function(xhr,type,errorThrown){
    //异常处理；
    //console.log(type);
	  switch (type) {
		  case "timeout":
			  mui.toast('连接超时，请重试');
			  break;
		  default:
			  mui.toast('请重试或重新登录');
	  }
  }
});



/*获取开奖停售时间*/
mui.ajax(config[0].url+'/index.php/cpdlt_endtime',{
  data:{
  	type:'01',
  },
  dataType:'json',//服务器返回json格式数据
  type:'get',//HTTP请求类型
  timeout:10000,//超时时间设置为10秒；
  success:function(data){
    if(typeof data == "string") {var data = eval('('+data+')');}
   /*console.log(JSON.stringify(data));*/
    /*console.log(arr[data]);*/ 
	var mydate = new Date(data);
	M = (mydate.getMonth()+1 < 10 ? '0'+(mydate.getMonth()+1) : mydate.getMonth()+1) + '-';
	D = mydate.getDate() ;
  jQuery('.e_time').html(M+D+"&nbsp;&nbsp;20:00");
  
  
  }, 
  error:function(xhr,type,errorThrown){
    //异常处理；
    //console.log(type);
	  switch (type) {
		  case "timeout":
			  mui.toast('连接超时，请重试');
			  break;
		  default:
			  mui.toast('请重试或重新登录');
	  }
  }
});






</script>



</html>